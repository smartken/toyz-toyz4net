Class=new Object();Class.forName=function(fullNS){var nsArray=fullNS.split(".");var sEval="";var sNS="";for(var i=0;i<nsArray.length;i++){if(i!=0){sNS+="."}sNS+=nsArray[i];sEval+="if (typeof("+sNS+") == 'undefined') "+sNS+" = new Object();"}if(sEval!=""){eval(sEval)}};Class.forName("Toyz4js.util");Toyz4js.util={isDateFormat:function(c,d){if(c.length!=d.length){return false}var a=c;a=a.replace(/yyyy/,"[0-9]{4}");a=a.replace(/yy/,"[0-9]{2}");a=a.replace(/MM/,"((0[1-9])|1[0-2])");a=a.replace(/M/,"(([1-9])|1[0-2])");a=a.replace(/dd/,"((0[1-9])|([1-2][0-9])|30|31)");a=a.replace(/d/,"([1-9]|[1-2][0-9]|30|31))");a=a.replace(/HH/,"(([0-1][0-9])|20|21|22|23)");a=a.replace(/H/,"([0-9]|1[0-9]|20|21|22|23)");a=a.replace(/mm/,"([0-5][0-9])");a=a.replace(/m/,"([0-9]|([1-5][0-9]))");a=a.replace(/ss/,"([0-5][0-9])");a=a.replace(/s/,"([0-9]|([1-5][0-9]))");var b=new RegExp("^"+a+"$");return b.test(d)},parseDateTime:function(m,o){if(m.length!=o.length){return null}var b=m.indexOf("yyyy");var g=m.indexOf("MM");var a=m.indexOf("dd");var q=m.indexOf("HH");var i=m.indexOf("mm");var c=m.indexOf("ss");var l=new Date();try{if(b==-1||g==-1||a==-1){return null}var n=parseInt(o.substr(b,4));var j=parseInt(o.substr(g,2));var p=parseInt(o.substr(a,2));l.setFullYear(n,j-1,p);if(q!=-1){var h=parseInt(o.substr(q,2));l.setHours(h)}if(i!=-1){var f=parseInt(o.substr(f,2));l.setMinutes(f)}if(c!=-1){var e=parseInt(o.substr(c,2));l.setSeconds(e)}return l}catch(k){return null}},strToJson:function(jsonStr){return eval("("+jsonStr+")")},handleJsonResult:function(b,d){var g=b.msg||"";var f=b.title||"操作";var c=b.icon||"info";var e=b.action||"show";var a=false;if(e=="show"){$.messager.show({title:f,msg:g,timeout:5000,showType:"slide",showSpeed:500})}else{if(e=="alert"){$.messager.alert(f,g,c,d==null?function(){return true}:d)}else{if(e=="confirm"){$.messager.confirm(f,g,d==null?function(h){return h}:d)}else{if(e=="prompt"){$.messager.prompt(f,g,d==null?function(h){return h}:d)}}}}},getIframeContext:function(a){return"<iframe frameborder='0' src='"+a+"' style='width:100%;height:100%;overflow:hidden;'></iframe>"},jsonToStr:function(f){switch(typeof(f)){case"object":var d=[];if(f instanceof Array){for(var e=0,b=f.length;e<b;e++){d.push(Toyz4js.util.jsonToStr(f[e]))}return"["+d.join(",")+"]"}else{if(f instanceof RegExp){return f.toString()}else{for(var c in f){d.push(c+":"+Toyz4js.util.jsonToStr(f[c]))}return"{"+d.join(",")+"}"}}case"function":return"function() {}";case"number":return f.toString();case"string":return'"'+f.replace(/(\\|\")/g,"\\$1").replace(/\n|\r|\t/g,function(g){return("\n"==g)?"\\n":("\r"==g)?"\\r":("\t"==g)?"\\t":""})+'"';case"boolean":return f.toString();default:return f.toString()}}};Class.forName("Toyz4js.custom.setting");Toyz4js.custom.setting={dbDateFormat:"yyyy-MM-dd",precision:2};Array.prototype.getUnionAttrStr=function(f,d){try{var e=new String();if(!d){d=","}for(var c=0;c<this.length;c++){var a=this[c][f];e+=a+d}e=e.substr(0,e.lastIndexOf(d));return e}catch(b){alert(b)}};Array.prototype.getUnionStr=function(d){try{var e=new String();if(!d){d=","}for(var c=0;c<this.length;c++){var a=this[c].toString();e+=a+d}e=e.substr(0,e.lastIndexOf(d));return e}catch(b){alert(b)}};String.prototype.toJson=function(){try{var json=eval("("+this.toString()+")");return json}catch(ex){return{}}};String.prototype.messager=function(e){try{var c=this.toJson();var h=c.msg||"";var g=c.title||"操作结果";var d=c.icon||"info";var f=c.action||"show";var a=false;if(f=="show"){$.messager.show({title:g,msg:h,timeout:5000,showType:"slide",showSpeed:500})}else{if(f=="alert"){$.messager.alert(g,h,d,e==null?function(){return true}:e)}else{if(f=="confirm"){$.messager.confirm(g,h,e==null?function(i){return i}:e)}else{if(f=="prompt"){$.messager.prompt(g,h,e==null?function(i){return i}:e)}}}}}catch(b){alert(b);$.messager.alert("Format error","The result is not a Messager format")}};String.prototype.isNullOrEmpty=function(){return((this==null)||(this==""))};String.prototype.isAlph=function(){return(/^[A-Za-z]+$/.test(this))};String.prototype.isAlphOrNum=function(){return(/^[A-Za-z0-9]+$/.test(this))};String.prototype.isNotSymbol=function(){return !(/[^0-9A-z\u4e00-\u9fa5]/.test(this))};String.prototype.isIdNoFormat=function(){return(/(^\d{15}$)|(^\d{17}([0-9]|X)$)/.test(this))};String.prototype.getIdNoBornDate=function(){var a=this.length;if(a==15){var c="19"+this.slice(6,8);var d=this.slice(8,10);var b=this.slice(10,12);return new Date(c+"/"+d+"/"+b)}if(a==18){var c=this.slice(6,10);var d=this.slice(10,12);var b=this.slice(12,14);return new Date(c+"/"+d+"/"+b)}};String.prototype.isPhoneFormat=function(){return(/^(0[0-9]{2,3}\-)?([2-9][0-9]{6,7})+(\-[0-9]{1,4})?$/).test(this)};String.prototype.isMobileFormat=function(){return(/^((\(\d{3}\))|(\d{3}\-))?13[0-9]\d{8}|15[89]\d{8}/).test(this)};String.prototype.isZipCode=function(){return(/[1-9]\d{5}(?!\d)/.test(this))};String.prototype.isChinese=function(){return(/[\u4e00-\u9fff]+/.test(this))};String.prototype.isFive=function(){return(/^\d{5,5}$/.test(this))};String.prototype.carNo=function(){return(/\d{5}$|[A-Z]{1}\d{4}|\d{1}[A-Z]{1}\d{3}|[A-Z]{2}\d{3}$/.test(this))};String.prototype.ip=function(){return(/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/.test(this))};jQuery.fn.extend({toyzLoadFields:function(){$(this).find("input:enabled").each(function(){if($(this).hasClass("easyui-combobox")){$(this).combobox()}else{if($(this).hasClass("toyz-intbox")){$(this).toyzIntbox()}else{if($(this).hasClass("toyz-doublebox")){$(this).toyzDoublebox()}else{if($(this).hasClass("toyz-combogrid")){$(this).toyzCombogrid()}else{if($(this).hasClass("toyz-datebox")){$(this).toyzDatebox()}}}}}});return true},toyzIframe:function(a){$(this).html("<iframe scrolling='no' frameborder='0' src='"+a+"' style='width:99%;height:99%;overflow:hidden;'></iframe>")},toyzAuthFields:function(a){var b=$(this);if(!a){return false}b.find("input").each(function(){var d=$(this).attr("name")||null;if(d){var c=a[d];switch(c){case 0:$(this).addClass("invisible").attr("disabled","disabled");break;case 1:$(this).addClass("readonly").attr("readonly","true");break;default:$(this).addClass("editable")}}});return true},toyzCombogrid:function(opts){var thisObj=$(this);var thisName=thisObj.attr("name")||"";var thisValueField=thisObj.attr("valueField")||"value";var thisTextField=thisObj.attr("textField")||"text";var thisUrl=thisObj.attr("url")||"";var thisRequired=thisObj.attr("required")||true;var selecterWidth=thisObj.attr("selecterWidth")||80;var thisDisabled=thisObj.attr("disabled");var thisDataEval=thisObj.attr("dataEval")||"";if(opts){thisValueField=opts.valueField||"value";thisTextField=opts.textField||"text";thisUrl=opts.url||"";thisRequired=opts.required||true;selecterWidth=opts.selecterWidth||80;thisDisabled=opts.disabled;thisDataEval=opts.dataEval||""}var thisWidth=thisObj.width();var thisHeight=thisObj.height();thisObj.width(thisWidth-selecterWidth);var thisValue=thisObj.val()||"";var selecterObj=$("<input>").width(selecterWidth);thisObj.before(selecterObj);thisObj.combobox({hasDownArrow:false,editable:false,required:thisRequired,textField:thisTextField,valueField:thisValueField});selecterObj.combogrid({panelWidth:thisWidth,disabled:thisDisabled,idField:thisValueField,textField:thisValueField,value:thisValue,columns:[[{field:thisValueField,width:selecterWidth},{field:thisTextField,width:thisWidth}]],onChange:function(nv,ov){if(!nv||!ov||nv==ov){return}thisObj.combobox("select",nv)},onSelect:function(index,r){thisObj.combobox("select",r[thisValueField])}});var grid=selecterObj.combogrid("grid");if(thisDataEval!=""){var gridData=eval(thisDataEval);if(gridData){grid.datagrid("loadData",gridData);thisObj.combobox("loadData",gridData.rows)}}else{if(thisUrl!=""){$.getJSON(thisUrl,function(gridData){grid.datagrid("loadData",gridData);thisObj.combobox("loadData",gridData.rows)})}}},toyzDatebox2:function(){try{var c=$(this);var b=c.attr("value")||"";var a="";if(b!=""){var g=Date.parse(b);a=g.toString(Toyz4js.custom.setting.dbDateFormat);c.val(a)}c.datebox({onChange:Toyz4js.easyui.datebox.onChangeHandler,onSelect:function(d){c.datebox("setValue",d.format(Toyz4js.custom.setting.dbDateFormat))}});var f=c.next().find("input:first");f.blur(function(){if($(this).val()==null||$(this).val()==""){return}var h=Toyz4js.util.isDateFormat(Toyz4js.custom.setting.dbDateFormat,$(this).val());if(h){var j=dateboxObj.datebox("calendar");var i=j.calendar("options");var k=i.current;c.datebox("setValue",k.format(Toyz4js.custom.setting.dbDateFormat))}else{$.messager.show({title:"输入错误",msg:"日期格式必须符合"+Toyz4js.custom.setting.dbDateFormat});c.datebox("setValue",a)}})}catch(e){}},toyzDatebox:function(){var c=$(this);var b=c.attr("value")||"";var a="";if(b!=""){try{var f=new Date(b);a=f.toString(Toyz4js.custom.setting.dbDateFormat);c.val(a)}catch(e){}}else{c.val("")}c.datebox({validType:"date['yyyy-MM-dd']"})},toyzDoublebox:function(){$(this).numberbox({increment:10,precision:Toyz4js.setting.precision})},toyzIntbox:function(){$(this).numberbox({increment:10,precision:0})},toyzCrudForm:function(b){try{var f=b.prefix||"";var c=b.colNum||2;var l=b.editors||[];var o=b.urlSave||"";var d=b.urlRemove||"";var e=b.data||{};var p=$("<div></div>");p.css("overflow","hidden");var i=$("<form method='post'></form>");var h=$("<table cellspacing='0' ></table>");h.addClass("tableSimple");h.css("table-layout","auto");$.each(e,function(q,s){var r=$('<input type="hidden" />');r.attr("name",f+q).attr("value",s);i.append(r)});var m;$.each(l,function(y,x){if(y%c==0){m=$("<tr></tr>")}var z=x.field||"";var t=x.title||"";var A="input[name='"+f+z+"']";i.find("input").remove(A);var v=$("<td>&nbsp;</td>");var r=$("<th>&nbsp;</th>");var B=x.editor||{type:"text"};var q=B.type;var w=B.options||{};var u;if(q=="textarea"){u=$("<textarea rows='5' cols='50'></textarea>");u.html(e[z])}else{if(q=="checkbox"){u=$("<input type='checkbox' value='Y' />")}else{u=$("<input type='text' />");u.val(e[z])}}u.attr("name",f+z);var C=$("<span></span>");C.html(t);v.append(u);r.append(C).append(":");m.append(r);m.append(v);if(y%c==c-1||y==l.length-1){h.append(m)}switch(q){case"validatebox":u.validatebox(w);break;case"numberbox":u.numberbox(w);break;case"numberspinner":u.numberspinner(w);break;case"combobox":u.combobox(w);break;case"combotree":u.combotree(w);break;case"combogrid":u.combogrid(w);break;case"toyzCombogrid":u.toyzCombogrid(w);break;case"datebox":var s=u.val();s=DateFormatter(s);u.val(s);u.datebox(w);break;case"datetimebox":var s=u.val();s=DatetimeFormatter(s);u.val(s);u.datetimebox(w);break;default:u.validatebox(w);break}});var n=$("<tr></tr>");var k=$("<th></th>");k.css("padding-right","3%");n.append(k);k.attr("colspan",c*2);var g=$("<a></a>");var a=$("<a></a>");k.append(g);k.append(a);g.linkbutton({text:"保存",iconCls:"icon-save"});a.linkbutton({text:"清空",iconCls:"icon-cancel"});g.click(function(){i.form("submit",{url:o,onSubmit:function(){return $(this).form("validate")},success:function(q){q.messager();$(".crud").dialog("close")}})});a.click(function(){i.form("clear")});h.append(n);i.append(h);p.append(i);$(this).html(p)}catch(j){}},toyzUploadForm:function(a){if(!a){a={}}var i=a.uploadUrl||"#";var g=a.inputName||"file";var c=a.muti||false;var b=$("<div></div>");var m=$("<table></table>");var h=$("<ol type='1'></ol>");var k=$("<span></span>");var d=$("<form method='post' enctype='multipart/form-data'></form>");d.attr("action",i);var e=$("<a></a>");var f=$("<a></a>");e.linkbutton({text:"新增",iconCls:"icon-add"});f.linkbutton({text:"提交",iconCls:"icon-save"});e.click(function(){var n=$("<li></li>");var p=$("<input type='file' />");p.attr("name",g);var o=$("<button type='button'>删除</button>");o.click(function(){n.remove()});n.append(p).append("&nbsp;&nbsp;").append(o);h.append(n)});f.click(function(){d.form("submit")});if(c){k.append(e)}k.append(f);var l=$("<li></li>");var j=$("<input type='file' />");j.attr("name",g);l.append(j);h.append(l);b.css("padding","1%");k.css("width","100%").css("text-align","right").css("padding-right","5%");d.append(h);d.append(k);b.append(d);$(this).html(b)}});$.extend($.fn.validatebox.defaults.rules,{minLength:{validator:function(a,b){return a.length>=b[0]},message:"Please enter at least {0} characters."},datetime:{validator:function(b,c){var a=c[0]||Toyz4js.custom.setting.dbDateFormat;return Toyz4js.util.isDateFormat(a,b)},message:"日期格式必须符合 {0}"},idCard:{validator:function(a,b){return a.isIdNoFormat()},message:"身份证格式错误"},zip:{validator:function(a,b){return a.isZipCode()},message:"邮政编码格式错误"},phone:{validator:function(a,b){return a.isPhoneFormat()},message:"电话号码格式错误"},mobile:{validator:function(a,b){return a.isMobileFormat()},message:"手机号码格式错误"},Chinese:{validator:function(a,b){return a.isChinese()},message:"只能是中文"},five:{validator:function(a,b){return a.isFive()},message:"输入格式错误"},carno:{validator:function(a,b){return a.carNo()},message:"车牌输入格式错误"},ip:{validator:function(a,b){return a.ip()},message:"IP输入格式错误"}});$.fn.panel.defaults.onMove=function(h,g){if(h<0){$(this).panel("move",{left:10})}if(g<0){$(this).panel("move",{top:10})}var d=h+$(this).width();var e=g+$(this).height();var i=parseInt(window.innerWidth);var c=parseInt(window.innerHeight);if(d>i){var f=i-$(this).width()-30;$(this).panel("move",{left:f})}if(e>c){var a=c-$(this).height()-50;$(this).panel("move",{top:a})}};$.fn.window.defaults.onMove=$.fn.panel.defaults.onMove;$.fn.window.defaults.shadow=false;$.fn.form.defaults.success=function(a){$.messager.progress("close");a.messager(null)};$.fn.form.defaults.onSubmit=function(){var a=$(this).form("validate");if(a){$.messager.progress({msg:"请求处理中，请稍候",text:""})}return a};$.fn.form.defaults.onLoadError=function(){$.messager.progress("close");$.messager.alert("Error","Can't access to the remote site.","error")};$.fn.datagrid.defaults.fit=true;$.fn.datagrid.defaults.pagination=true;$.fn.datagrid.defaults.nowrap=false;$.fn.datagrid.defaults.idField="id";$.fn.datagrid.defaults.rownumbers=true;$.fn.datagrid.defaults.pageSize=20;$.fn.datagrid.defaults.groupFormatter=function(b,a){return b+" - 共"+a.length+" 条"};$.fn.combobox.defaults.textField="text";$.fn.combobox.defaults.valueField="value";function DateFormatter(value,rowData,rowIndex){try{var dv=value.substring(1,value.length-1);var dt=eval("new "+dv);return dt.toString("yyyy-MM-dd")}catch(ex){return""}}function DateTimeFormatter(value,rowData,rowIndex){try{var dv=value.substring(1,value.length-1);var dt=eval("new "+dv);return dt.toString("yyyy-MM-dd HH:mm:ss")}catch(ex){return""}}function DictFormatter(c){var b=Toyz4js.cache["DictModel"][c]["rows"]||[];var a=function(f,e,j){for(var d=0;d<b.length;d++){var h=b[d];var g=h.value||"";if(g.toString()==f.toString()){return h.text||""}}return f};return a}function GeoFormatter(){var b=Toyz4js.cache["GeoModel"]["rows"]||[];var a=function(e,d,h){for(var c=0;c<b.length;c++){var f=b[c];var g=f.id||"";if(g.toString()==e.toString()){return f.cityName||""}}return e};return a}function RoleFormatter(){var a=Toyz4js.cache["RoleModel"]["rows"]||[];var b=function(e,d,h){for(var c=0;c<a.length;c++){var g=a[c];var f=g.id||"";if(f.toString()==e.toString()){return g.name||""}}return e};return b}function IndFormatter(b,a,c){if(b=="Y"){return"是"}else{return"否"}}function HotelFormatter(){var a=Toyz4js.cache["HotelModel"]["rows"]||[];var b=function(e,d,h){for(var c=0;c<a.length;c++){var f=a[c];var g=f.hotelId||"";if(g.toString()==e.toString()){return f.hotelName||""}}return e};return b}function ToyzOperaFormatter(e){e=e||{};var d=e.iconCls||"file";var a=e.href||"";var c=e.handlerName||"";var b=function(h,g,j){var f;var i=Toyz4js.util.jsonToStr(g);if(a==""){f="<a onclick='"+c+"("+i+","+j+")' class='toyz-icon "+d+"'></a>"}else{f="<a href='"+a+"' class='toyz-icon "+d+"'></a>"}return f};return b}function ImgFormatter(a){return function(d,c,e){if(d.length==0){return""}var b="<img src='"+d+"'";if(a){b+=" style='"+a+"' "}b+=" />";return b}}function HrefFormatter(a){return function(d,c,e){if(d.length==0){return""}var b="<a href='"+d+"' target='_blank'";if(a){b+=" style='"+a+"' "}b+=" >"+d+"</a>";return b}}function NumberDescSorter(b,a){return b>a}function StringDescSorter(b,a){return b.localeCompare(a)}function GetIndEditor(){return{type:"combobox",options:{data:[{text:"是",value:"Y"},{text:"否",value:"N"}],textField:"text",valueField:"value"}}}function LikeFilter(a){return function(c,b){b[a].indexOf(c)!=-1}}var CrudDatagrid=function(a){this._urlAdd=a.urlAdd||"";this._urlRemove=a.urlRemove||"";this._urlUpdate=a.urlUpdate||"";this._urlExportExcel=a.urlExportExcel||"";this._regexp=a.regexp||"";this._id=a.id||"Id";this._initRow=a.initRow||function(){return{}};this._editors=a.editors};CrudDatagrid.prototype.getToolbar=function(a){a=a||{};var n=new this._initRow();var g=this._regexp;var b=this._id;var e=this._urlRemove;var i=this._urlAdd;var d=this._urlUpdate;var c=this._urlExportExcel;var l={};l.editors=this._editors;l.prefix=a.prefix||"";var f={iconCls:"icon-add",text:"新建",handler:function(){l.data=n;l.urlSave=i;var p=$("<div></div>");p.addClass("crud");p.toyzCrudForm(l);p.dialog({title:"新建记录",modal:true,onClose:function(){$(this).dialog("destroy",true)},onDestroy:function(){$(g).datagrid("reload")}})}};var k={iconCls:"icon-edit",text:"修改",handler:function(){var p=$(g).datagrid("getSelected");if(!p){$.messager.alert("","没有记录被选中","error");return}var s=$(g).datagrid("getRowIndex",p);l.data=p;l.urlSave=d;var q="修改记录序号:"+(s+1);var r=$("<div></div>");r.addClass("crud");r.toyzCrudForm(l);r.dialog({title:q,modal:true,onClose:function(){$(this).dialog("destroy",true)},onDestroy:function(){$(g).datagrid("reload")}})}};var m={iconCls:"icon-remove",text:"删除",handler:function(){var p=$(g).datagrid("getSelections");var r=p.length;if(r==0){$.messager.alert("","没有记录被选中","error");return}var q="";q=p.getUnionAttrStr(b,",");$.messager.confirm("操作提示","是否删除"+r+"条记录",function(s){if(s){$.post(e,{ids:q},function(u){try{u.toString().messager();$(g).datagrid("clearSelections");$(g).datagrid("reload")}catch(t){alert(t)}})}})}};var j={iconCls:"icon-reload",text:"刷新",handler:function(){$(g).datagrid("clearSelections");$(g).datagrid("reload")}};var o={iconCls:"icon-help",text:"导出excel",handler:function(){if(c.length<1){$.messager.alert("操作错误","没有配置excel路径","error");return}var p=$("<div></div>");var x=$("<table></table>");x.css("padding","10px");var v;var q;var s;var r;var w;v=$("<tr></tr>");q=$("<th></th>");s=$("<td></td>");r=$("<td></td>");w=$("<a></a>");var t=$(g).datagrid("getData")["total"]||0;q.html("全部记录数:");s.html(t).css("width","100px");r.css("width","120px");w.attr("href",c);r.append(w);w.linkbutton({text:"导出"});v.append(q).append(s).append(r);x.append(v);v=$("<tr></tr>");q=$("<th></th>");s=$("<td></td>");r=$("<td></td>");w=$("<a></a>");var u=$(g).datagrid("getSelections").length||0;q.html("已选记录数:");s.html(u);w.attr("href",c);r.append(w);w.linkbutton({text:"导出"});v.append(q).append(s).append(r);x.append(v);v=$("<tr></tr>");q=$("<th></th>");s=$("<td></td>");r=$("<td></td>");w=$("<a></a>");var y=$(g).datagrid("getRows").length||0;q.html("当前页记录数:");s.html(y);w.attr("href",c);r.append(w);w.linkbutton({text:"导出"});v.append(q).append(s).append(r);x.append(v);p.append(x);p.dialog({title:"导出excel"})}};var h=[f,k,m,j];return h};CrudDatagrid.prototype.getOperaFormatter=function(){try{var i=new this._initRow();var f=this._regexp;var a=this._id;var d=this._urlRemove;var g=this._urlAdd;var c=this._urlUpdate;var h={};h.editors=this._editors;var b=function(m,p,k){var l=$("<span></span>");var j=$("<a id='aEdit'></a>");var o=$("<a></a>");var n="$('<div></div>').dialog({width:600,height:400});";l.append(j);l.find("#aEdit").attr("title","编辑").attr("href","javascript:void(0)").addClass("toyz-icon").addClass("edit").attr("onclick",n);alert(l.html());return l.html()};return b}catch(e){alert(e)}};CrudDatagrid.prototype.getEditRowHandler=function(d){d=d||{};var g=this._regexp;var h=this._id;var c=this._urlRemove;var f=this._urlAdd;var b=this._urlUpdate;var e={};e.editors=this._editors;e.prefix=d.prefix||"";var a=function(n,k){e.data=k;e.urlSave=b;var j=parseInt(n);var l="修改记录序号:"+(j+1);var m=$("<div></div>");m.addClass("crud");m.toyzCrudForm(e);m.dialog({title:l,modal:true,onClose:function(){$(this).dialog("destroy",true)},onDestroy:function(){$(g).datagrid("reload")}})};return a};function dateboxFormatter(c,e,b){if(c==null||c==""){return""}var d="";if(typeof(c)=="number"){var a=new Date();a.setTime(c);return a.toString("yyyy-MM-dd")}else{return c}}function dateTimeboxFormatter(c,d,b){if(c==null||c==""){return""}var a=new Date();a.setTime(c);if(a==null){return c}return a.toString("yyyy-MM-dd HH:mm:ss")};